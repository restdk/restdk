{"version":3,"file":"client.cjs.js","sources":["../src/base.ts","../src/api-service/defaultService.ts","../src/index.ts"],"sourcesContent":["export class Api {\n  protected parent: null | Api;\n  protected url: string;\n\n  protected getUrl(): string {\n    return (this.parent?.getUrl() ?? \"\") + this.url;\n  }\n}\n","import { Api } from \"../base\";\n\nexport class User {}\n\nexport class UserApi extends Api {\n  constructor(private request) {\n    super();\n  }\n\n  gets(): Promise<User[]> {\n    return this.request({});\n  }\n}\n\nexport function defaultService(request) {\n  return {\n    userApi: new UserApi(request),\n  };\n}\n","import { Axios } from \"axios\";\nimport * as project from \"./api-service\";\n\ntype Project = typeof project;\ntype ProjectKeys = keyof Project;\ntype ProjectMap = {\n  [key in ProjectKeys]: ReturnType<Project[key]>;\n};\n\nexport function createRestdk(appName: ProjectKeys, restdkOption) {\n  const axios = new Axios(restdkOption);\n  axios.interceptors.request.use((config) => {\n    return config;\n  });\n  axios.interceptors.response.use((res) => {\n    if (Math.floor(res.status / 100) !== 2) {\n      throw new Error(res.statusText);\n    }\n    const body: any = res.data;\n    if (body?.code) {\n      //TODO: 抛错管理\n    }\n    return body?.data;\n  });\n  const restdkApi = project[appName];\n  return restdkApi((option) => {\n    return axios.request({\n      method: option.method,\n      url: parseUrlParam(option.url, option.param),\n      data: option.body,\n      params: option.query,\n    });\n  });\n}\n\nfunction parseUrlParam(url: string, param: any) {\n  return url.replace(/:(w+)/gim, (_, $1) => {\n    return param[$1];\n  });\n}\n"],"names":["axios","Axios"],"mappings":";;;;;;MAAa,GAAG;IACJ,MAAM,CAAa;IACnB,GAAG,CAAS;IAEZ,MAAM;QACd,OAAO,CAAC,IAAI,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,IAAI,IAAI,CAAC,GAAG,CAAC;KACjD;;;MCFU,OAAQ,SAAQ,GAAG;IACV;IAApB,YAAoB,OAAO;QACzB,KAAK,EAAE,CAAC;QADU,YAAO,GAAP,OAAO,CAAA;KAE1B;IAED,IAAI;QACF,OAAO,IAAI,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;KACzB;CACF;SAEe,cAAc,CAAC,OAAO;IACpC,OAAO;QACL,OAAO,EAAE,IAAI,OAAO,CAAC,OAAO,CAAC;KAC9B,CAAC;AACJ;;;;;;;SCTgB,YAAY,CAAC,OAAoB,EAAE,YAAY;IAC7D,MAAMA,OAAK,GAAG,IAAIC,WAAK,CAAC,YAAY,CAAC,CAAC;IACtCD,OAAK,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,MAAM;QACpC,OAAO,MAAM,CAAC;KACf,CAAC,CAAC;IACHA,OAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC,GAAG;QAClC,IAAI,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,MAAM,GAAG,GAAG,CAAC,KAAK,CAAC,EAAE;YACtC,MAAM,IAAI,KAAK,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;SACjC;QACD,MAAM,IAAI,GAAQ,GAAG,CAAC,IAAI,CAAC;QAC3B,IAAI,IAAI,EAAE,IAAI,EAAE,CAEf;QACD,OAAO,IAAI,EAAE,IAAI,CAAC;KACnB,CAAC,CAAC;IACH,MAAM,SAAS,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;IACnC,OAAO,SAAS,CAAC,CAAC,MAAM;QACtB,OAAOA,OAAK,CAAC,OAAO,CAAC;YACnB,MAAM,EAAE,MAAM,CAAC,MAAM;YACrB,GAAG,EAAE,aAAa,CAAC,MAAM,CAAC,GAAG,EAAE,MAAM,CAAC,KAAK,CAAC;YAC5C,IAAI,EAAE,MAAM,CAAC,IAAI;YACjB,MAAM,EAAE,MAAM,CAAC,KAAK;SACrB,CAAC,CAAC;KACJ,CAAC,CAAC;AACL,CAAC;AAED,SAAS,aAAa,CAAC,GAAW,EAAE,KAAU;IAC5C,OAAO,GAAG,CAAC,OAAO,CAAC,UAAU,EAAE,CAAC,CAAC,EAAE,EAAE;QACnC,OAAO,KAAK,CAAC,EAAE,CAAC,CAAC;KAClB,CAAC,CAAC;AACL;;;;"}